{
  "builders": [
    {
      "vm_name": "WindowsServer2016Insider",
      "type": "hyperv-iso",
      "disk_size": 41440,
      "boot_wait": "0s",
      "boot_command": [
        "a<enter><wait>a<enter><wait>a<enter><wait>a<enter>"
      ],
      "guest_additions_mode": "disable",
      "generation": 2,
      "iso_url": "{{user `iso_url`}}",
      "iso_checksum_type": "{{user `iso_checksum_type`}}",
      "iso_checksum": "{{user `iso_checksum`}}",
      "secondary_iso_images": [
        "./windows/2016_insider/answer.iso"
      ],
      "communicator": "winrm",
      "winrm_username": "vagrant",
      "winrm_password": "vagrant",
      "winrm_timeout": "4h",
      "shutdown_command": "shutdown /s /t 10 /f /d p:4:1 /c \"Packer Shutdown\"",
      "ram_size": 8192,
      "cpu": 8,
      "enable_dynamic_memory": true,
      "switch_name": "{{user `hyperv_switchname`}}",
      "enable_secure_boot": true,
      "enable_virtualization_extensions": true,
      "http_directory": "d:\\iso\\16278"
    }
  ],
  "provisioners": [
    {
      "type": "windows-shell",
      "scripts": [
        "./scripts/enable-rdp.bat"
      ]
    },
    {
      "type": "powershell",
      "scripts": [
        "./scripts/docker/button-down.ps1"
      ]
    },
    {
      "type": "powershell",
      "inline":
      [
        "Install-WindowsFeature -Name Containers"
      ]
    },
    {
      "type": "windows-restart"
    },
    {
      "type": "powershell",
      "environment_vars":
      [
        "dockerVersion={{user `dockerVersion`}}"
      ],
      "scripts": [
        "./scripts/docker/2016/install-docker.ps1",
        "./scripts/docker/add-docker-group.ps1",
        "./scripts/docker/docker-pull-local.ps1"
      ]
    }
  ],
  "variables": {
    "manually_download_iso_from": "https://www.microsoft.com/en-us/software-download/windowsinsiderpreviewserver",
    "iso_url": "https://software-download.microsoft.com/pr/Windows_InsiderPreview_Server_16267.iso",
    "iso_checksum_type": "none",
    "iso_checksum": "1FA3EEED8555DD6E120727A7DB6B47B2987357B7001F6B5AF2A732A12CB61EC3",
    "autounattend": "./answer_files/2016_insider/Autounattend.xml"
  }
}